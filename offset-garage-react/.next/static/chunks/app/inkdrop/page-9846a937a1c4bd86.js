(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[541],{7812:function(e,t,r){Promise.resolve().then(r.bind(r,8638))},8638:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var n=r(7437),a=r(2265),o=r(7527),s=r(1169),i=r(9201),c=r(5943),l=e=>{let{id:t,content:r,ratio:a,initialLeft:o,initialTop:s,isLocalhost:i,onDelete:l}=e,{draggableRef:u,position:d,isDragging:h}=(0,c.Z)({initialLeft:o,initialTop:s}),m="thumbnail-box guestbook-entry ".concat(a," ").concat(h?"dragging":"");return(0,n.jsxs)("div",{ref:u,className:m,style:{left:"".concat(d.left,"px"),top:"".concat(d.top,"px")},children:[i&&(0,n.jsx)("button",{className:"delete-button absolute top-2 right-2 text-red-500 text-fs-18 font-bold cursor-pointer z-10",onClick:()=>l(t),children:"X"}),(0,n.jsx)("div",{className:"content text-only initial-padding",children:(0,n.jsx)("p",{className:"text-fs-18",children:r})})]})},u=e=>{let{onNewEntry:t}=e,[r,o]=(0,a.useState)(""),s=(0,a.useRef)(null);return(0,a.useEffect)(()=>{s.current&&(s.current.style.height="auto",s.current.style.height=s.current.scrollHeight+"px")},[r]),(0,n.jsxs)("div",{className:"guestbook-input-container",children:[(0,n.jsx)("textarea",{id:"guestbook-input",className:"text-fs-18",placeholder:"방명록을 남겨주세요 (최대 100자)...",maxLength:100,value:r,onChange:e=>{e.target.value.length<=100&&o(e.target.value)},ref:s,rows:1}),(0,n.jsxs)("div",{className:"input-controls",children:[(0,n.jsxs)("span",{id:"char-count",className:"text-fs-12 text-gray-500",children:[r.length,"/",100]}),(0,n.jsx)("button",{id:"drop-it-button",className:"nav-button",onClick:()=>{r.trim()&&(t(r),o(""))},children:"drop it!"})]})]})},d=r(2025),h=r(9748);function m(){let[e,t]=(0,a.useState)(!1),{resolvedTheme:r}=(0,d.F)(),[c,m]=(0,a.useState)([]),[f,g]=(0,a.useState)(null),[p,x]=(0,a.useState)(!1),v=(0,h.Z)(c),b=(e,t)=>{g({message:e,type:t}),setTimeout(()=>{g(null)},3e3)},w=async()=>{try{let e=await fetch("/api/guestbook",{cache:"no-store"});if(!e.ok)throw Error("Failed to fetch guestbook entries");let t=(await e.json()).map(e=>({...e,ratio:function(){let e=["ratio-1-1","ratio-16-9","ratio-4-3","ratio-3-4","ratio-9-16","ratio-2-1","ratio-1-2","ratio-1-3"];return e[Math.floor(Math.random()*e.length)]}()}));m(t)}catch(e){console.error(e),b("방명록을 불러오는 데 실패했습니다.","error")}},k=async e=>{m(t=>t.filter(t=>t.id!==e));try{let t=await fetch("/api/guestbook?id=".concat(e),{method:"DELETE"});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to delete entry")}b("방명록이 성공적으로 삭제되었습니다.","success")}catch(e){console.error(e),b(e.message||"방명록 삭제에 실패했습니다.","error"),m(c)}};(0,a.useEffect)(()=>{w(),x("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname)},[]);let j=async e=>{if(0===e.length){b("방명록 내용을 입력해주세요.","error");return}if(e.length>100){b("글자 수 초과: ".concat(e.length,"/100"),"error");return}try{let t=await fetch("/api/guestbook",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to post new entry")}b("방명록이 성공적으로 게시되었습니다.","success"),w()}catch(e){console.error(e),b(e.message||"방명록 작성에 실패했습니다.","error")}};return(0,n.jsxs)("div",{children:[(0,n.jsx)(o.Z,{onAboutClick:()=>t(!0)}),(0,n.jsx)("main",{id:"guestbook-grid",children:c.map(e=>{let t=v[e.id];return t?(0,n.jsx)(l,{initialLeft:t.left,initialTop:t.top,isLocalhost:p,onDelete:k,...e},e.id):null})}),(0,n.jsx)(u,{onNewEntry:j}),f&&(0,n.jsx)("div",{id:"guestbook-message",className:"guestbook-message text-fs-14 ".concat("error"===f.type?"text-red-500":""),children:f.message}),(0,n.jsx)(s.Z,{isVisible:e,onClose:()=>t(!1)}),(0,n.jsx)(i.Z,{})]})}},1169:function(e,t,r){"use strict";var n=r(7437);r(2265),t.Z=e=>{let{isVisible:t,onClose:r}=e;return t?(0,n.jsx)("div",{id:"about-overlay",className:t?"":"hidden",children:(0,n.jsxs)("div",{className:"about-content",children:[(0,n.jsx)("button",{id:"close-about-button",onClick:r,children:"(CLOSE)"}),(0,n.jsx)("h2",{children:"About OFFSET GARAGE"}),(0,n.jsx)("p",{className:"text-fs-18",children:"**우리가게 정상영업 합니다**"})]})}):null}},9201:function(e,t,r){"use strict";var n=r(7437);r(2265),t.Z=()=>(0,n.jsx)("footer",{className:"site-footer-bottom",children:(0,n.jsx)("p",{className:"text-fs-14",children:"(C) 2025. OFFSET GARAGE. LEE HANSOL ALL RIGHTS RESERVED."})})},7527:function(e,t,r){"use strict";var n=r(7437),a=r(3145),o=r(7648),s=r(2265),i=r(2025);t.Z=e=>{let{onAboutClick:t}=e,{theme:r,setTheme:c,resolvedTheme:l}=(0,i.F)(),[u,d]=(0,s.useState)(!1),h=e=>{c(e),d(!1)};return(0,n.jsxs)("header",{className:"site-header",children:[(0,n.jsxs)("div",{className:"header-left",children:[(0,n.jsx)(o.default,{href:"/",className:"logo-link",children:(0,n.jsx)("div",{className:"logo-box",children:(0,n.jsx)(a.default,{src:"/images/logo.svg",alt:"OFFSET GARAGE Logo",fill:!0,style:{objectFit:"contain"}})})}),(0,n.jsxs)("nav",{className:"header-nav",children:[(0,n.jsx)(o.default,{href:"/inkdrop",className:"nav-button",children:"Inkdrop"}),(0,n.jsx)("button",{className:"nav-button",onClick:t,children:"About"})]})]}),(0,n.jsxs)("div",{className:"theme-switcher",children:[(0,n.jsxs)("button",{id:"theme-toggle-button",className:"theme-button",onClick:()=>d(!u),children:["(",r.toUpperCase(),")"]}),(0,n.jsxs)("div",{id:"theme-dropdown",className:"theme-dropdown ".concat(u?"":"hidden"),children:[(0,n.jsx)("button",{"data-theme":"system",onClick:()=>h("system"),children:"SYSTEM"}),(0,n.jsx)("button",{"data-theme":"light",onClick:()=>h("light"),children:"LIGHT"}),(0,n.jsx)("button",{"data-theme":"dark",onClick:()=>h("dark"),children:"DARK"})]})]})]})}},2025:function(e,t,r){"use strict";r.d(t,{F:function(){return i},ThemeProvider:function(){return s}});var n=r(7437),a=r(2265);let o=(0,a.createContext)(void 0),s=e=>{let{children:t}=e,[r,s]=(0,a.useState)(()=>localStorage.getItem("theme")||"system"),[i,c]=(0,a.useState)("light");return(0,a.useEffect)(()=>{let e=e=>{let t;let r=window.matchMedia("(prefers-color-scheme: dark)").matches;c(t="system"===e?r?"dark":"light":e),document.documentElement.classList.remove("dark"),"dark"===t&&document.documentElement.classList.add("dark"),document.body.classList.remove("light-mode","dark-mode"),"dark"===t?document.body.classList.add("dark-mode"):document.body.classList.add("light-mode")};e(r);let t=window.matchMedia("(prefers-color-scheme: dark)"),n=()=>{"system"===r&&e("system")};return t.addEventListener("change",n),()=>t.removeEventListener("change",n)},[r]),(0,n.jsx)(o.Provider,{value:{theme:r,setTheme:e=>{s(e),localStorage.setItem("theme",e)},resolvedTheme:i},children:t})},i=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},5943:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(2265);function a(e){let{initialLeft:t,initialTop:r,excludeTags:a=[]}=e,[o,s]=(0,n.useState)({left:t,top:r}),[i,c]=(0,n.useState)(!1),l=(0,n.useRef)(!1),u=(0,n.useRef)(null),d=(0,n.useRef)(null),h=(0,n.useRef)({isDown:!1,startX:0,startY:0,currentTranslateX:t,currentTranslateY:r});(0,n.useCallback)(e=>{let t=window.getComputedStyle(e),r=t.transform||t.webkitTransform,n=r.match(/^matrix\((.+)\)$/);return n?{x:parseFloat(n[1].split(", ")[4]),y:parseFloat(n[1].split(", ")[5])}:(n=r.match(/^matrix3d\((.+)\)$/))?{x:parseFloat(n[1].split(", ")[12]),y:parseFloat(n[1].split(", ")[13])}:{x:0,y:0}},[]);let m=(0,n.useCallback)(()=>{if(!u.current)return;let{currentTranslateX:e,currentTranslateY:t}=h.current;u.current.style.transform="translate(".concat(e,"px, ").concat(t,"px)"),d.current=null},[]),f=(0,n.useCallback)(e=>{if(!h.current.isDown)return;let t=e.clientX-h.current.startX,r=e.clientY-h.current.startY;(Math.abs(t)>3||Math.abs(r)>3)&&(l.current=!0),h.current.currentTranslateX=o.left+t,h.current.currentTranslateY=o.top+r,d.current||(d.current=requestAnimationFrame(m))},[o.left,o.top,m]),g=(0,n.useCallback)(()=>{h.current.isDown=!1,c(!1),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g),s({left:h.current.currentTranslateX,top:h.current.currentTranslateY}),d.current&&(cancelAnimationFrame(d.current),d.current=null)},[f]),p=(0,n.useCallback)(e=>{u.current&&(console.log("onMouseDown triggered on:",e.target.tagName),e.preventDefault(),e.stopPropagation(),h.current.isDown=!0,h.current.startX=e.clientX,h.current.startY=e.clientY,l.current=!1,c(!0),document.addEventListener("mousemove",f),document.addEventListener("mouseup",g))},[f,g]);return(0,n.useEffect)(()=>{let e=u.current;return e&&(e.style.position="absolute",e.style.transform="translate(".concat(o.left,"px, ").concat(o.top,"px)"),e.addEventListener("mousedown",p)),()=>{e&&e.removeEventListener("mousedown",p),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g),d.current&&cancelAnimationFrame(d.current)}},[p,f,g,o.left,o.top]),{draggableRef:u,position:o,isDragging:i,dragOccurred:l}}},9748:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(2265);let a=e=>{switch(e){case"ratio-1-1":return{width:300,height:300};case"ratio-16-9":return{width:420,height:236.25};case"ratio-4-3":return{width:360,height:270};case"ratio-3-4":return{width:270,height:360};case"ratio-9-16":return{width:236.25,height:420};case"ratio-2-1":return{width:400,height:200};case"ratio-1-2":return{width:200,height:400};case"ratio-1-3":return{width:150,height:450};default:return{width:0,height:0}}};var o=e=>{let[t,r]=(0,n.useState)({}),[o,s]=(0,n.useState)(!1),i=(0,n.useRef)([]);return(0,n.useEffect)(()=>{s(!0)},[]),(0,n.useEffect)(()=>{if(!o)return;let t={};i.current=[],e.forEach(e=>{let r=0,n=!1,o=0,s=0,{width:c,height:l}=a(e.ratio);if(0===c||0===l){console.warn("Invalid ratio or dimensions for thumbnail ".concat(e.id,": ").concat(e.ratio)),t[e.id]={left:0,top:0},i.current.push({id:e.id,left:0,top:0,width:0,height:0});return}do{let e=window.innerWidth-20-20-c,t=window.innerHeight-100-70-l;o=Math.random()*e+20,s=Math.random()*t+100,o=Math.max(20,Math.min(o,window.innerWidth-c-20)),s=Math.max(100,Math.min(s,window.innerHeight-l-70));let a=!1;for(let e of i.current){let t=Math.max(0,Math.min(o+c,e.left+e.width)-Math.max(o,e.left)),r=Math.max(0,Math.min(s+l,e.top+e.height)-Math.max(s,e.top));if(t>50||r>50){a=!0;break}}a||(n=!0),r++}while(!n&&r<100);t[e.id]={left:o,top:s},i.current.push({id:e.id,left:o,top:s,width:c,height:l})}),r(t)},[e,o]),t}}},function(e){e.O(0,[726,971,117,744],function(){return e(e.s=7812)}),_N_E=e.O()}]);