(()=>{var e={};e.id=541,e.ids=[541],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3637:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),r(1237),r(1278),r(5866);var s=r(3191),a=r(8716),n=r(7922),o=r.n(n),i=r(5231),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);r.d(t,l);let c=["",{children:["inkdrop",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1237)),"/Users/hansol/Documents/06-development/offset-garage/offset-garage-react/src/app/inkdrop/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,1278)),"/Users/hansol/Documents/06-development/offset-garage/offset-garage-react/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/hansol/Documents/06-development/offset-garage/offset-garage-react/src/app/inkdrop/page.tsx"],u="/inkdrop/page",h={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/inkdrop/page",pathname:"/inkdrop",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},2450:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},8408:(e,t,r)=>{Promise.resolve().then(r.bind(r,3016))},3645:(e,t,r)=>{Promise.resolve().then(r.bind(r,8604))},8604:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(326),a=r(7577),n=r(6427),o=r(1135),i=r(6134),l=r(492);let c=({id:e,content:t,ratio:r,initialLeft:a,initialTop:n,isLocalhost:o,onDelete:i})=>{let{draggableRef:c,position:d,isDragging:u}=(0,l.Z)({initialLeft:a,initialTop:n}),h=`thumbnail-box guestbook-entry ${r} ${u?"dragging":""}`;return(0,s.jsxs)("div",{ref:c,className:h,style:{left:`${d.left}px`,top:`${d.top}px`},children:[o&&s.jsx("button",{className:"delete-button absolute top-2 right-2 text-red-500 text-fs-18 font-bold cursor-pointer z-10",onClick:()=>i(e),children:"X"}),s.jsx("div",{className:"content text-only initial-padding",children:s.jsx("p",{className:"text-fs-18",children:t})})]})},d=({onNewEntry:e})=>{let[t,r]=(0,a.useState)(""),n=(0,a.useRef)(null);return(0,a.useEffect)(()=>{n.current&&(n.current.style.height="auto",n.current.style.height=n.current.scrollHeight+"px")},[t]),(0,s.jsxs)("div",{className:"guestbook-input-container",children:[s.jsx("textarea",{id:"guestbook-input",className:"text-fs-18",placeholder:"방명록을 남겨주세요 (최대 100자)...",maxLength:100,value:t,onChange:e=>{e.target.value.length<=100&&r(e.target.value)},ref:n,rows:1}),(0,s.jsxs)("div",{className:"input-controls",children:[(0,s.jsxs)("span",{id:"char-count",className:"text-fs-12 text-gray-500",children:[t.length,"/",100]}),s.jsx("button",{id:"drop-it-button",className:"nav-button",onClick:()=>{t.trim()&&(e(t),r(""))},children:"drop it!"})]})]})};var u=r(3016),h=r(5216);function m(){let[e,t]=(0,a.useState)(!1),{resolvedTheme:r}=(0,u.F)(),[l,m]=(0,a.useState)([]),[p,g]=(0,a.useState)(null),[f,x]=(0,a.useState)(!1),v=(0,h.Z)(l),b=(e,t)=>{g({message:e,type:t}),setTimeout(()=>{g(null)},3e3)},w=async()=>{try{let e=await fetch("/api/guestbook",{cache:"no-store"});if(!e.ok)throw Error("Failed to fetch guestbook entries");let t=(await e.json()).map(e=>({...e,ratio:function(){let e=["ratio-1-1","ratio-16-9","ratio-4-3","ratio-3-4","ratio-9-16","ratio-2-1","ratio-1-2","ratio-1-3"];return e[Math.floor(Math.random()*e.length)]}()}));m(t)}catch(e){console.error(e),b("방명록을 불러오는 데 실패했습니다.","error")}},k=async e=>{m(t=>t.filter(t=>t.id!==e));try{let t=await fetch(`/api/guestbook?id=${e}`,{method:"DELETE"});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to delete entry")}b("방명록이 성공적으로 삭제되었습니다.","success")}catch(e){console.error(e),b(e.message||"방명록 삭제에 실패했습니다.","error"),m(l)}},j=async e=>{if(0===e.length){b("방명록 내용을 입력해주세요.","error");return}if(e.length>100){b(`글자 수 초과: ${e.length}/100`,"error");return}try{let t=await fetch("/api/guestbook",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to post new entry")}b("방명록이 성공적으로 게시되었습니다.","success"),w()}catch(e){console.error(e),b(e.message||"방명록 작성에 실패했습니다.","error")}};return(0,s.jsxs)("div",{children:[s.jsx(n.Z,{onAboutClick:()=>t(!0)}),s.jsx("main",{id:"guestbook-grid",children:l.map(e=>{let t=v[e.id];return t?s.jsx(c,{initialLeft:t.left,initialTop:t.top,isLocalhost:f,onDelete:k,...e},e.id):null})}),s.jsx(d,{onNewEntry:j}),p&&s.jsx("div",{id:"guestbook-message",className:`guestbook-message text-fs-14 ${"error"===p.type?"text-red-500":""}`,children:p.message}),s.jsx(o.Z,{isVisible:e,onClose:()=>t(!1)}),s.jsx(i.Z,{})]})}},1135:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(326);r(7577);let a=({isVisible:e,onClose:t})=>e?s.jsx("div",{id:"about-overlay",className:e?"":"hidden",children:(0,s.jsxs)("div",{className:"about-content",children:[s.jsx("button",{id:"close-about-button",onClick:t,children:"(CLOSE)"}),s.jsx("h2",{children:"About OFFSET GARAGE"}),s.jsx("p",{className:"text-fs-18",children:"**우리가게 정상영업 합니다**"})]})}):null},6134:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(326);r(7577);let a=()=>s.jsx("footer",{className:"site-footer-bottom",children:s.jsx("p",{className:"text-fs-14",children:"(C) 2025. OFFSET GARAGE. LEE HANSOL ALL RIGHTS RESERVED."})})},6427:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var s=r(326),a=r(6226),n=r(434),o=r(7577),i=r(3016);let l=({onAboutClick:e})=>{let{theme:t,setTheme:r,resolvedTheme:l}=(0,i.F)(),[c,d]=(0,o.useState)(!1),u=e=>{r(e),d(!1)};return(0,s.jsxs)("header",{className:"site-header",children:[(0,s.jsxs)("div",{className:"header-left",children:[s.jsx(n.default,{href:"/",className:"logo-link",children:s.jsx("div",{className:"logo-box",children:s.jsx(a.default,{src:"/images/logo.svg",alt:"OFFSET GARAGE Logo",fill:!0,style:{objectFit:"contain"}})})}),(0,s.jsxs)("nav",{className:"header-nav",children:[s.jsx(n.default,{href:"/inkdrop",className:"nav-button",children:"Inkdrop"}),s.jsx("button",{className:"nav-button",onClick:e,children:"About"})]})]}),(0,s.jsxs)("div",{className:"theme-switcher",children:[(0,s.jsxs)("button",{id:"theme-toggle-button",className:"theme-button",onClick:()=>d(!c),children:["(",t.toUpperCase(),")"]}),(0,s.jsxs)("div",{id:"theme-dropdown",className:`theme-dropdown ${c?"":"hidden"}`,children:[s.jsx("button",{"data-theme":"system",onClick:()=>u("system"),children:"SYSTEM"}),s.jsx("button",{"data-theme":"light",onClick:()=>u("light"),children:"LIGHT"}),s.jsx("button",{"data-theme":"dark",onClick:()=>u("dark"),children:"DARK"})]})]})]})}},3016:(e,t,r)=>{"use strict";r.d(t,{F:()=>i,ThemeProvider:()=>o});var s=r(326),a=r(7577);let n=(0,a.createContext)(void 0),o=({children:e})=>{let[t,r]=(0,a.useState)(()=>"system"),[o,i]=(0,a.useState)("light");return(0,a.useEffect)(()=>{let e=e=>{let t;let r=window.matchMedia("(prefers-color-scheme: dark)").matches;i(t="system"===e?r?"dark":"light":e),document.documentElement.classList.remove("dark"),"dark"===t&&document.documentElement.classList.add("dark"),document.body.classList.remove("light-mode","dark-mode"),"dark"===t?document.body.classList.add("dark-mode"):document.body.classList.add("light-mode")};e(t);let r=window.matchMedia("(prefers-color-scheme: dark)"),s=()=>{"system"===t&&e("system")};return r.addEventListener("change",s),()=>r.removeEventListener("change",s)},[t]),s.jsx(n.Provider,{value:{theme:t,setTheme:e=>{r(e)},resolvedTheme:o},children:e})},i=()=>{let e=(0,a.useContext)(n);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},492:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(7577);function a(e){let{initialLeft:t,initialTop:r,excludeTags:a=[]}=e,[n,o]=(0,s.useState)({left:t,top:r}),[i,l]=(0,s.useState)(!1),c=(0,s.useRef)(!1),d=(0,s.useRef)(null),u=(0,s.useRef)(null),h=(0,s.useRef)({isDown:!1,startX:0,startY:0,currentTranslateX:t,currentTranslateY:r});(0,s.useCallback)(e=>{let t=window.getComputedStyle(e),r=t.transform||t.webkitTransform,s=r.match(/^matrix\((.+)\)$/);return s?{x:parseFloat(s[1].split(", ")[4]),y:parseFloat(s[1].split(", ")[5])}:(s=r.match(/^matrix3d\((.+)\)$/))?{x:parseFloat(s[1].split(", ")[12]),y:parseFloat(s[1].split(", ")[13])}:{x:0,y:0}},[]);let m=(0,s.useCallback)(()=>{if(!d.current)return;let{currentTranslateX:e,currentTranslateY:t}=h.current;d.current.style.transform=`translate(${e}px, ${t}px)`,u.current=null},[]),p=(0,s.useCallback)(e=>{if(!h.current.isDown)return;let t=e.clientX-h.current.startX,r=e.clientY-h.current.startY;(Math.abs(t)>3||Math.abs(r)>3)&&(c.current=!0),h.current.currentTranslateX=n.left+t,h.current.currentTranslateY=n.top+r,u.current||(u.current=requestAnimationFrame(m))},[n.left,n.top,m]),g=(0,s.useCallback)(()=>{h.current.isDown=!1,l(!1),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g),o({left:h.current.currentTranslateX,top:h.current.currentTranslateY}),u.current&&(cancelAnimationFrame(u.current),u.current=null)},[p]);return(0,s.useCallback)(e=>{d.current&&(console.log("onMouseDown triggered on:",e.target.tagName),e.preventDefault(),e.stopPropagation(),h.current.isDown=!0,h.current.startX=e.clientX,h.current.startY=e.clientY,c.current=!1,l(!0),document.addEventListener("mousemove",p),document.addEventListener("mouseup",g))},[p,g]),{draggableRef:d,position:n,isDragging:i,dragOccurred:c}}},5216:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(7577);let a=e=>{switch(e){case"ratio-1-1":return{width:300,height:300};case"ratio-16-9":return{width:420,height:236.25};case"ratio-4-3":return{width:360,height:270};case"ratio-3-4":return{width:270,height:360};case"ratio-9-16":return{width:236.25,height:420};case"ratio-2-1":return{width:400,height:200};case"ratio-1-2":return{width:200,height:400};case"ratio-1-3":return{width:150,height:450};default:return{width:0,height:0}}},n=e=>{let[t,r]=(0,s.useState)({}),[n,o]=(0,s.useState)(!1),i=(0,s.useRef)([]);return(0,s.useEffect)(()=>{o(!0)},[]),(0,s.useEffect)(()=>{if(!n)return;let t={};i.current=[],e.forEach(e=>{let r=0,s=!1,n=0,o=0,{width:l,height:c}=a(e.ratio);if(0===l||0===c){console.warn(`Invalid ratio or dimensions for thumbnail ${e.id}: ${e.ratio}`),t[e.id]={left:0,top:0},i.current.push({id:e.id,left:0,top:0,width:0,height:0});return}do{let e=window.innerWidth-20-20-l,t=window.innerHeight-100-70-c;n=Math.random()*e+20,o=Math.random()*t+100,n=Math.max(20,Math.min(n,window.innerWidth-l-20)),o=Math.max(100,Math.min(o,window.innerHeight-c-70));let a=!1;for(let e of i.current){let t=Math.max(0,Math.min(n+l,e.left+e.width)-Math.max(n,e.left)),r=Math.max(0,Math.min(o+c,e.top+e.height)-Math.max(o,e.top));if(t>50||r>50){a=!0;break}}a||(s=!0),r++}while(!s&&r<100);t[e.id]={left:n,top:o},i.current.push({id:e.id,left:n,top:o,width:l,height:c})}),r(t)},[e,n]),t}},1237:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`/Users/hansol/Documents/06-development/offset-garage/offset-garage-react/src/app/inkdrop/page.tsx#default`)},1278:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i,metadata:()=>o});var s=r(9510);r(5023);var a=r(8570);let n=(0,a.createProxy)(String.raw`/Users/hansol/Documents/06-development/offset-garage/offset-garage-react/src/context/ThemeContext.tsx#ThemeProvider`);(0,a.createProxy)(String.raw`/Users/hansol/Documents/06-development/offset-garage/offset-garage-react/src/context/ThemeContext.tsx#useTheme`);let o={title:"OFFSET GARAGE",description:"Creative Archiving and Sharing Space"};function i({children:e}){return s.jsx("html",{lang:"ko",children:s.jsx("body",{children:s.jsx(n,{children:e})})})}},5023:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,471,285],()=>r(3637));module.exports=s})();